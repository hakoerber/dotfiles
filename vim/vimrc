" vim: set filetype=vim

set nocompatible
filetype off
set rtp+=~/.vim/bundle/Vundle.vim/
call vundle#begin()

Plugin 'VundleVim/Vundle.vim'

Plugin 'bling/vim-airline'
Plugin 'godlygeek/tabular'
Plugin 'lepture/vim-jinja'
Plugin 'majutsushi/tagbar'
Plugin 'nblock/vim-dokuwiki'
Plugin 'reedes/vim-pencil'
Plugin 'saltstack/salt-vim'
Plugin 'sickill/vim-monokai'
Plugin 'tpope/vim-commentary'
Plugin 'tpope/vim-fugitive'
Plugin 'tpope/vim-speeddating'
Plugin 'tpope/vim-surround'

"Plugin 'Lokaltog/vim-easymotion'
"Plugin 'PeterRincker/vim-argumentative'
"Plugin 'Valloric/YouCompleteMe'
"Plugin 'flazz/vim-colorschemes'
"Plugin 'jmcantrell/vim-virtualenv'
"Plugin 'kien/ctrlp.vim'
"Plugin 'klen/python-mode'
"Plugin 'mbbill/undotree'
"Plugin 'scrooloose/nerdtree'
"Plugin 'sjl/gundo.vim'
"Plugin 'terryma/vim-expand-region'
"Plugin 'terryma/vim-multiple-cursors'
"Plugin 'wellle/targets.vim'
"Plugin 'wincent/Command-T'

call vundle#end()
filetype plugin indent on

set t_Co=256

set autochdir
set autoindent
set autoread
set backspace=indent,eol,start
set backupcopy=no
set colorcolumn=80
set confirm
set cursorline
set directory=/var/tmp,/tmp
set encoding=utf-8
set esckeys
set expandtab
set foldenable
set foldmethod=indent
set foldnestmax=2
set gdefault
set hidden
set history=1000
set hlsearch
set ignorecase
set incsearch
set laststatus=2
set lazyredraw
set linebreak
set magic
set matchpairs="(:),{:},[:],<:>"
set matchtime=5
set modeline
set modelines=5
set mouse=a
set mousehide
set nobackup
set noerrorbells
set nofoldenable
set noshowmode
set notildeop
set notimeout
set nowritebackup
set number
set numberwidth=2
set pastetoggle=<F11>
set relativenumber
set ruler
set scrolloff=7
set shiftround
set shiftwidth=4
set shortmess=rti
set showcmd
set showmatch
set showmode
set smartcase
set smartindent
set smarttab
set softtabstop=4
set swapfile
set tabstop=4
set title
set titlestring=""
set ttimeout
set ttimeoutlen=50
set ttyfast
set undodir=~/.vim/undo
set undofile
set undolevels=1000
set undoreload=10000
set updatecount=200
set updatetime=10000
set viewdir=~/.vim/view
set virtualedit+="block"
set virtualedit="onemore,all"
set whichwrap+=h,l
set wildignore=*.swp,*.bak,*.pyc,*~,*.o
set wildmenu
set wildmode=list:longest
set wrap
set wrapscan
let mapleader = "\<Space>"
map <leader>w: w!<cr>

nnoremap <Leader>w :w<CR>
nmap <Leader><Leader> za
map , :

vnoremap <silent> y y`]
vnoremap <silent> p p`]
nnoremap <silent> p p`]

nnoremap <leader>, :nohlsearch<CR>

noremap gV `[v`]

map Y y$
map j gj
map k gk

nnoremap <C-h> <C-w>h
nnoremap <C-j> <C-w>j
nnoremap <C-k> <C-w>k
nnoremap <C-l> <C-w>l

" Autosave views when closing and restoring when opening again.
autocmd BufWinLeave *.* mkview
autocmd BufWinEnter *.* silent loadview

nmap <C-n> :bnext<CR>
nmap <C-p> :bprev<CR>

inoremap jj <ESC>

nnoremap <leader>v <C-w>v<C-w>l

nmap ; :CtrlPBuffer<CR>

" no more ex mode
nnoremap Q <nop>

" setup for the solarized color theme
set background=dark
let g:solarized_termcolors=16
let g:solarized_termtrans=1
let g:solarized_contrast="normal"
let g:solarized_visibility="normal"
syntax enable
colorscheme monokai

nnoremap <F10> :TagbarToggle<CR>
let g:tagbar_map_jump = "i"
let g:tagbar_left = 0
let g:tagbar_vertical = 0
let g:tagbar_width = 50
let g:tagbar_autoclose = 1
let g:tagbar_autofocus = 1
let g:tagbar_sort = 0 " 1: sort by name, 0: sort by position
let g:tagbar_compact = 1
let g:tagbar_indent = 2
let g:tagbar_show_linenumbers = 0
let g:tagbar_foldlevel = 99 " unfold all

let g:airline_right_sep = ''
let g:airline_left_sep = ''
let g:airline#extensions#disable_rtp_load = 1
let g:airline_extensions = ['whitespace']
let g:airline_theme='powerlineish'
let g:airline_section_x = airline#section#create(['%{tagbar#currenttag("%s", "", "f")}','' , ' %{PencilMode()}', ' [', 'filetype', ']'])
let g:pencil#mode_indicators = {'hard': 'H', 'auto': 'A', 'soft': 'S', 'off': '',}
let g:airline#extensions#whitespace#enabled = 1
let g:airline#extensions#whitespace#symbol = ''
let g:airline#extensions#whitespace#checks = ['trailing']

function! DeleteTrailingWS()
     exe "normal mz"
     %s/\s\+$//e
     exe "normal `z"
endfunction
autocmd BufWrite * :call DeleteTrailingWS()
